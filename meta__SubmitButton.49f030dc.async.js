(self.webpackChunk_byte_n_antd_ext=self.webpackChunk_byte_n_antd_ext||[]).push([[7187],{79744:function(n,t,e){"use strict";e.d(t,{Z:function(){return c}});var u=e(58709),l=e(75271),r={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M909.3 506.3L781.7 405.6a7.23 7.23 0 00-11.7 5.7V476H548V254h64.8c6 0 9.4-7 5.7-11.7L517.7 114.7a7.14 7.14 0 00-11.3 0L405.6 242.3a7.23 7.23 0 005.7 11.7H476v222H254v-64.8c0-6-7-9.4-11.7-5.7L114.7 506.3a7.14 7.14 0 000 11.3l127.5 100.8c4.7 3.7 11.7.4 11.7-5.7V548h222v222h-64.8c-6 0-9.4 7-5.7 11.7l100.8 127.5c2.9 3.7 8.5 3.7 11.3 0l100.8-127.5c3.7-4.7.4-11.7-5.7-11.7H548V548h222v64.8c0 6 7 9.4 11.7 5.7l127.5-100.8a7.3 7.3 0 00.1-11.4z"}}]},name:"drag",theme:"outlined"},_=r,a=e(47221),s=function(m,d){return l.createElement(a.Z,(0,u.Z)({},m,{ref:d,icon:_}))},f=l.forwardRef(s),c=f},20860:function(n,t,e){"use strict";e.d(t,{Z:function(){return c}});var u=e(58709),l=e(75271),r={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M464 688a48 48 0 1096 0 48 48 0 10-96 0zm24-112h48c4.4 0 8-3.6 8-8V296c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v272c0 4.4 3.6 8 8 8z"}}]},name:"exclamation-circle",theme:"outlined"},_=r,a=e(47221),s=function(m,d){return l.createElement(a.Z,(0,u.Z)({},m,{ref:d,icon:_}))},f=l.forwardRef(s),c=f},37236:function(n,t,e){"use strict";e.d(t,{Z:function(){return c}});var u=e(58709),l=e(75271),r={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M859.9 474H164.1c-4.5 0-8.1 3.6-8.1 8v60c0 4.4 3.6 8 8.1 8h695.8c4.5 0 8.1-3.6 8.1-8v-60c0-4.4-3.6-8-8.1-8zm-353.6-74.7c2.9 3.7 8.5 3.7 11.3 0l100.8-127.5c3.7-4.7.4-11.7-5.7-11.7H550V104c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v156h-62.8c-6 0-9.4 7-5.7 11.7l100.8 127.6zm11.4 225.4a7.14 7.14 0 00-11.3 0L405.6 752.3a7.23 7.23 0 005.7 11.7H474v156c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V764h62.8c6 0 9.4-7 5.7-11.7L517.7 624.7z"}}]},name:"vertical-align-middle",theme:"outlined"},_=r,a=e(47221),s=function(m,d){return l.createElement(a.Z,(0,u.Z)({},m,{ref:d,icon:_}))},f=l.forwardRef(s),c=f},50223:function(n,t,e){"use strict";var u;e.r(t),e.d(t,{demos:function(){return v}});var l=e(90228),r=e.n(l),_=e(87999),a=e.n(_),s=e(75271),f=e(69457),c=e(70920),h=e(53046),m=e(43003),d=e(64215),v={"submitbutton-demo-basic":{component:s.memo(s.lazy(function(){return e.e(9698).then(e.bind(e,85943))})),asset:{type:"BLOCK",id:"submitbutton-demo-basic",refAtomIds:["SubmitButton"],dependencies:{"index.tsx":{type:"FILE",value:e(59246).Z},antd:{type:"NPM",value:"5.26.4"},"@byte.n/antd-ext":{type:"NPM",value:"1.0.1"},react:{type:"NPM",value:"18.3.1"},"../../hooks/useFormRuleBuilder.ts":{type:"FILE",value:e(51135).Z},"../utils/formRule.ts":{type:"FILE",value:e(75556).Z}},entry:"index.tsx"},context:{"../../hooks/useFormRuleBuilder.ts":h,"../utils/formRule.ts":d,antd:f,"@byte.n/antd-ext":c,react:u||(u=e.t(s,2)),"/home/runner/work/antd-ext/antd-ext/src/hooks/useFormRuleBuilder.ts":h,"antd/es/locale":m,"/home/runner/work/antd-ext/antd-ext/src/utils/formRule.ts":d},renderOpts:{compile:function(){var g=a()(r()().mark(function o(){var i,x=arguments;return r()().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.next=2,e.e(5413).then(e.bind(e,85413));case 2:return b.abrupt("return",(i=b.sent).default.apply(i,x));case 3:case"end":return b.stop()}},o)}));function p(){return g.apply(this,arguments)}return p}()}}}},53046:function(n,t,e){"use strict";e.r(t),e.d(t,{useFormRuleBuilder:function(){return s}});var u=e(48305),l=e.n(u),r=e(76480),_=e(75271),a=e(64215);function s(){var f=(0,r.Z)("FormRuleBuilder",a.defaultFormRuleBuilderMessageTemplates),c=l()(f,1),h=c[0];return(0,_.useMemo)(function(){return new a.FormRuleBuilder(h)},[h])}t.default=s},64215:function(n,t,e){"use strict";e.r(t),e.d(t,{FormRuleBuilder:function(){return d},default:function(){return v},defaultFormRuleBuilderMessageTemplates:function(){return h}});var u=e(26068),l=e.n(u),r=e(25298),_=e.n(r),a=e(17069),s=e.n(a),f=e(82092),c=e.n(f),h={required:"${label}\u4E3A\u5FC5\u586B\u9879",regexp:"${label}\u683C\u5F0F\u4E0D\u6B63\u786E",length:"${label}\u957F\u5EA6\u5E94\u5728${min}\u5230${max}\u4E4B\u95F4",interval:"${label}\u5E94\u5728${min}\u5230${max}\u4E4B\u95F4",arrayRequired:"\u8BF7\u81F3\u5C11\u9009\u62E9\u4E00\u9879${label}"};function m(g,p){return p?g.replace(/\$\{(\w+)\}/g,function(o,i){return p[i]!==void 0?String(p[i]):o}):g}var d=function(){function g(p){_()(this,g),c()(this,"rule",void 0),c()(this,"messageTemplates",void 0),this.rule=[],this.messageTemplates=l()(l()({},h),p)}return s()(g,[{key:"if",value:function(o,i){return o?(i(this),this):this}},{key:"required",value:function(o){var i=o||m(this.messageTemplates.required);return this.rule.push({required:!0,message:i}),this}},{key:"regexp",value:function(o,i){var x=i||m(this.messageTemplates.regexp);return this.rule.push({pattern:o,message:x}),this}},{key:"length",value:function(o,i,x){var I=x||m(this.messageTemplates.length,{min:o,max:i});return this.rule.push({max:i,min:o,message:I}),this}},{key:"interval",value:function(o,i,x){var I=x||m(this.messageTemplates.interval,{min:o,max:i});return this.rule.push({max:i,min:o,message:I}),this}},{key:"validator",value:function(o){return this.rule.push({validator:o}),this}},{key:"arrayRequired",value:function(o){var i=o||m(this.messageTemplates.arrayRequired);return this.validator(function(x,I){return I!=null&&I.length?Promise.resolve():Promise.reject(i)})}},{key:"build",value:function(){return this.rule}}]),g}();function v(g){return new d(g)}},3989:function(n,t,e){"use strict";e.r(t),e.d(t,{texts:function(){return u}});const u=[{value:"\u667A\u80FD\u63D0\u4EA4\u6309\u94AE\u7EC4\u4EF6\uFF0C\u6839\u636E\u8868\u5355\u503C\u53D8\u5316\u81EA\u52A8\u542F\u7528/\u7981\u7528\uFF0C\u5E76\u63D0\u4F9B\u76F8\u5E94\u7684\u63D0\u793A\u4FE1\u606F\u3002",paraId:0,tocIndex:0},{value:"\u5C5E\u6027",paraId:1,tocIndex:2},{value:"\u7C7B\u578B",paraId:1,tocIndex:2},{value:"\u9ED8\u8BA4\u503C",paraId:1,tocIndex:2},{value:"\u8BF4\u660E",paraId:1,tocIndex:2},{value:"formInitialValues",paraId:1,tocIndex:2},{value:"T",paraId:1,tocIndex:2},{value:"-",paraId:1,tocIndex:2},{value:"\u8868\u5355\u521D\u59CB\u503C\uFF0C\u7528\u4E8E\u6BD4\u8F83\u8868\u5355\u5F53\u524D\u503C\u662F\u5426\u6709\u53D8\u5316",paraId:1,tocIndex:2},{value:"tooltipProps",paraId:1,tocIndex:2},{value:"Omit<TooltipProps, 'title' | 'open'>",paraId:1,tocIndex:2},{value:"-",paraId:1,tocIndex:2},{value:"Tooltip \u7EC4\u4EF6\u7684\u914D\u7F6E\u5C5E\u6027\uFF0C\u6392\u9664 ",paraId:1,tocIndex:2},{value:"title",paraId:1,tocIndex:2},{value:" \u548C ",paraId:1,tocIndex:2},{value:"open",paraId:1,tocIndex:2},{value:"...",paraId:1,tocIndex:2},{value:"-",paraId:1,tocIndex:2},{value:"-",paraId:1,tocIndex:2},{value:"\u7EE7\u627F ButtonProps \u7684\u6240\u6709\u5C5E\u6027 \u6392\u9664\uFF1A ",paraId:1,tocIndex:2},{value:"disabled",paraId:1,tocIndex:2},{value:"\u3001",paraId:1,tocIndex:2},{value:"htmlType",paraId:1,tocIndex:2}]},59246:function(n,t){"use strict";t.Z=`import { Form, Input, message } from 'antd';
import { SubmitButton } from '@byte.n/antd-ext';
import { useFormRuleBuilder } from '../../hooks/useFormRuleBuilder';
import React, { useState } from 'react';

export default () => {
  const [form] = Form.useForm();
  const [submittedData, setSubmittedData] = useState<typeof initialValues>();
  const initialValues = { name: '', email: 'test@example.com' };

  const ruleBuilder = useFormRuleBuilder();

  const onFinish = (values: typeof initialValues) => {
    setSubmittedData(values);
    message.success('\u8868\u5355\u63D0\u4EA4\u6210\u529F\uFF01');
  };

  return (
    <div>
      <Form
        form={form}
        initialValues={initialValues}
        onFinish={onFinish}
        layout="vertical"
      >
        <Form.Item
          label="\u59D3\u540D"
          name="name"
          required
          rules={ruleBuilder.required().build()}
        >
          <Input />
        </Form.Item>
        <Form.Item label="\u90AE\u7BB1" name="email">
          <Input />
        </Form.Item>
        <Form.Item>
          <SubmitButton formInitialValues={initialValues}>\u63D0\u4EA4</SubmitButton>
        </Form.Item>
      </Form>

      {submittedData && (
        <div
          style={{
            marginTop: 24,
            padding: 16,
            background: '#f6f8fa',
            borderRadius: 6,
          }}
        >
          <h4>\u5F53\u524D\u63D0\u4EA4\u7684\u4FE1\u606F\uFF1A</h4>
          <pre style={{ margin: 0, whiteSpace: 'pre-wrap' }}>
            {JSON.stringify(submittedData, null, 2)}
          </pre>
        </div>
      )}
    </div>
  );
};
`},51135:function(n,t){"use strict";t.Z=`import { useLocale } from 'antd/es/locale';
import { useMemo } from 'react';
import { defaultFormRuleBuilderMessageTemplates, FormRuleBuilder } from '../utils/formRule';

/**
 * FormRuleBuilder \u7684 Hook \u7248\u672C
 * \u652F\u6301\u672C\u5730\u5316 message\uFF0C\u4F18\u5148\u4F7F\u7528\u5916\u90E8\u4F20\u5165\u7684 message
 */
export function useFormRuleBuilder() {
  const [locale] = useLocale(
    'FormRuleBuilder',
    defaultFormRuleBuilderMessageTemplates,
  );

  return useMemo(() => {
    // \u76F4\u63A5\u4F7F\u7528 FormRuleBuilder \u7684 messageTemplates \u529F\u80FD
    return new FormRuleBuilder(locale);
  }, [locale]);
}

export default useFormRuleBuilder;
`},75556:function(n,t){"use strict";t.Z=`import { FormItemProps } from 'antd';

type Rule = Required<FormItemProps>['rules'][number];

// \u6D88\u606F\u6A21\u677F\u7C7B\u578B
export interface FormRuleBuilderMessageTemplates {
  required: string;
  regexp: string;
  length: string;
  interval: string;
  arrayRequired: string;
}

// \u9ED8\u8BA4\u6D88\u606F\u6A21\u677F
export const defaultFormRuleBuilderMessageTemplates: FormRuleBuilderMessageTemplates =
  {
    required: '\${label}\u4E3A\u5FC5\u586B\u9879',
    regexp: '\${label}\u683C\u5F0F\u4E0D\u6B63\u786E',
    length: '\${label}\u957F\u5EA6\u5E94\u5728\${min}\u5230\${max}\u4E4B\u95F4',
    interval: '\${label}\u5E94\u5728\${min}\u5230\${max}\u4E4B\u95F4',
    arrayRequired: '\u8BF7\u81F3\u5C11\u9009\u62E9\u4E00\u9879\${label}',
  };

/**
 * \u66FF\u6362\u6D88\u606F\u6A21\u677F\u4E2D\u7684\u5360\u4F4D\u7B26
 */
function replacePlaceholders(
  template: string,
  context?: Record<string, any>,
): string {
  if (!context) {
    return template;
  }
  return template.replace(/\\$\\{(\\w+)\\}/g, (match, key) => {
    return context[key] !== undefined ? String(context[key]) : match;
  });
}

/**
 * \u8868\u5355\u6821\u9A8C\u89C4\u5219\u6784\u9020\u5668
 */
export class FormRuleBuilder {
  rule: Rule[];
  messageTemplates: FormRuleBuilderMessageTemplates;

  constructor(messageTemplates?: Partial<FormRuleBuilderMessageTemplates>) {
    this.rule = [];
    this.messageTemplates = {
      ...defaultFormRuleBuilderMessageTemplates,
      ...messageTemplates,
    };
  }

  /**
   * \u6EE1\u8DB3\u6761\u4EF6\u5C31\u6267\u884C\u56DE\u8C03\u3002
   * @param condition
   * @param callback
   */
  if(condition: boolean, callback: (builder: FormRuleBuilder) => void) {
    if (!condition) {
      return this;
    }
    callback(this);
    return this;
  }

  /**
   * \u5FC5\u586B
   * @param message \u81EA\u5B9A\u4E49\u9519\u8BEF\u63D0\u793A\u6587\u672C\uFF0C\u652F\u6301\u5360\u4F4D\u7B26
   */
  required(message?: string) {
    const finalMessage =
      message || replacePlaceholders(this.messageTemplates.required);
    this.rule.push({ required: true, message: finalMessage });
    return this;
  }

  /**
   * \u6B63\u5219\u6821\u9A8C
   * @param reg
   * @param message \u81EA\u5B9A\u4E49\u9519\u8BEF\u63D0\u793A\u6587\u672C\uFF0C\u652F\u6301\u5360\u4F4D\u7B26
   */
  regexp(reg: RegExp, message?: string) {
    const finalMessage =
      message || replacePlaceholders(this.messageTemplates.regexp);
    this.rule.push({ pattern: reg, message: finalMessage });
    return this;
  }

  /**
   * \u5B57\u7B26\u4E32\u957F\u5EA6
   * @param min
   * @param max
   * @param message \u81EA\u5B9A\u4E49\u9519\u8BEF\u63D0\u793A\u6587\u672C\uFF0C\u652F\u6301\u5360\u4F4D\u7B26
   */
  length(min: number, max: number, message?: string) {
    const finalMessage =
      message ||
      replacePlaceholders(this.messageTemplates.length, { min, max });
    this.rule.push({ max, min, message: finalMessage });
    return this;
  }

  /**
   * \u6570\u5B57\u8303\u56F4
   * @param min
   * @param max
   * @param message \u81EA\u5B9A\u4E49\u9519\u8BEF\u63D0\u793A\u6587\u672C\uFF0C\u652F\u6301\u5360\u4F4D\u7B26
   */
  interval(min: number, max: number, message?: string) {
    const finalMessage =
      message ||
      replacePlaceholders(this.messageTemplates.interval, { min, max });
    this.rule.push({ max, min, message: finalMessage });
    return this;
  }

  /**
   * \u6B63\u5219\u6821\u9A8C
   * @param validator
   */
  validator<T = unknown>(
    validator: (
      rule: Rule,
      value: T,
      callback: (error?: string) => void,
    ) => Promise<void | unknown> | void,
  ) {
    this.rule.push({ validator });
    return this;
  }

  /**
   * \u5FC5\u987B\u662F\u6709\u6548\u6570\u7EC4
   * @param message \u81EA\u5B9A\u4E49\u9519\u8BEF\u63D0\u793A\u6587\u672C\uFF0C\u652F\u6301\u5360\u4F4D\u7B26
   * @param context \u5360\u4F4D\u7B26\u4E0A\u4E0B\u6587
   */
  arrayRequired(message?: string) {
    const finalMessage =
      message || replacePlaceholders(this.messageTemplates.arrayRequired);
    return this.validator((_, val: number[]) => {
      if (!val?.length) {
        return Promise.reject(finalMessage);
      }
      return Promise.resolve();
    });
  }

  /**
   * \u6784\u5EFA
   */
  build() {
    return this.rule;
  }

  //
  // buildToFormListRule () {
  //   return this.rule as FormListProps['rules'];
  // }
}

export default function formRule(
  messageTemplates?: Partial<FormRuleBuilderMessageTemplates>,
) {
  return new FormRuleBuilder(messageTemplates);
}
`},38498:function(n,t,e){var u=e(78770);function l(r){if(Array.isArray(r))return u(r)}n.exports=l,n.exports.__esModule=!0,n.exports.default=n.exports},335:function(n,t,e){var u=e(31479);function l(r,_){var a=typeof Symbol!="undefined"&&r[Symbol.iterator]||r["@@iterator"];if(!a){if(Array.isArray(r)||(a=u(r))||_&&r&&typeof r.length=="number"){a&&(r=a);var s=0,f=function(){};return{s:f,n:function(){return s>=r.length?{done:!0}:{done:!1,value:r[s++]}},e:function(v){throw v},f}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var c=!0,h=!1,m;return{s:function(){a=a.call(r)},n:function(){var v=a.next();return c=v.done,v},e:function(v){h=!0,m=v},f:function(){try{!c&&a.return!=null&&a.return()}finally{if(h)throw m}}}}n.exports=l,n.exports.__esModule=!0,n.exports.default=n.exports},20698:function(n){function t(e){if(typeof Symbol!="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}n.exports=t,n.exports.__esModule=!0,n.exports.default=n.exports},91162:function(n){function t(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}n.exports=t,n.exports.__esModule=!0,n.exports.default=n.exports},15558:function(n,t,e){var u=e(38498),l=e(20698),r=e(31479),_=e(91162);function a(s){return u(s)||l(s)||r(s)||_()}n.exports=a,n.exports.__esModule=!0,n.exports.default=n.exports}}]);
